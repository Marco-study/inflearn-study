# 스프링 MVC 2편 - 백엔드 웹 개발 활용 기술(김영한)
## 로그인 처리1 - 쿠키, 세션
- 로그인 상태 유지하기
  - 쿼리 파라미터를 계속 보낼 수도 있지만 매우 번거롭다. 
  - **쿠키를 사용하자.**
  - 로그인에 성공하면 서버에서 HTTP 응답에 쿠키를 담아서 전송. 
  - 이후부터 클라이언트는 쿠키를 가지고, 매번 HTTP 요청에 쿠키를 보냄.

- 쿠키의 종류
  - 영속 쿠키: 만료 날짜를 입력하면 해당 날짜까지 유지
  - 세션 쿠키: 브라우저를 종료할 때까지 유지. 
    - 쿠키에 시간 정보를 주지 않으면 세션 쿠키로 설정됨.

## 쿠키와 보안 문제
### 문제
- 쿠키 값은 임의로 변경 가능함.
  - 쿠키는 클라이언트에서 서버로 전송하는 것이기에 위변조가 가능함.
  - 쿠키를 강제로 변경하면 다른 사용자가 됨.
- 쿠키에 보관된 정보는 누구나 가져갈 수 있다.
- 해커가 훔쳐간 쿠키는 해커가 계속 사용 가능함.

### 대안
- 쿠키에 중요한 값을 노출하면 안됨.
- 노출되는 쿠키 값 형태가 예측 가능한 방식이면 안됨. 임의의 값을 사용하자.
- 해커카 쿠키를 털어가도 계속 사용할 수 없도록 만료시간을 짧게 설정하자.

## 로그인 처리하기 - 세션 동작 방식
세션
- 서버에서 중요한 정보를 저장하고, 추정 불가능한 임의의 값으로 클라이언트와 서버를 연결하는 것.

동작 방식
- 사용자가 로그인 정보를 전달하면, 서버에서 사용자가 맞는지 확인.
- 맞으면 추정 불가능한 세션 ID 생성.
- 세션 ID 를 key 로 하여 사용자 정보를 서버의 세션 저장소에 저장.
- 세션 ID 를 HTTP 응답에 담아 클라이언트에게 보냄.
- 클라이언트는 쿠키 저장소에 세션 ID 를 저장.
- 클라이언트는 매 요청마다 저장된 세션 ID 를 보냄.
- 서버는 요청을 받으면 받은 세션 ID 로 사용자 확인.

중요한 점
- 회원과 관련된 정보는 서버에서 클라이언트로 전혀 보내지 않았다는 점.
